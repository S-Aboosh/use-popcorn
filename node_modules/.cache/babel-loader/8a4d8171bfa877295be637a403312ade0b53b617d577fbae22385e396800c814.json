{"ast":null,"code":"import _regeneratorRuntime from\"D:/works/react_jonass_course/files/ultimate-react-course-main/07-usepopcorn/final/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/works/react_jonass_course/files/ultimate-react-course-main/07-usepopcorn/final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/works/react_jonass_course/files/ultimate-react-course-main/07-usepopcorn/final/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";var KEY=\"870ce811\";export function useMovies(query){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];useEffect(function(){//   callback?.();\nvar controller=new AbortController();function fetchMovies(){return _fetchMovies.apply(this,arguments);}function _fetchMovies(){_fetchMovies=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);setError(\"\");_context.next=5;return fetch(\"http://www.omdbapi.com/?apikey=\".concat(KEY,\"&s=\").concat(query),{signal:controller.signal});case 5:res=_context.sent;if(res.ok){_context.next=8;break;}throw new Error(\"some thing went worng with fetching movies\");case 8:_context.next=10;return res.json();case 10:data=_context.sent;if(!(data.response===\"False\")){_context.next=13;break;}throw new error(\"Movie Not Found\");case 13:setMovies(data.Search);setError(\"\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);if(_context.t0.name!==\"AbortError\"){console.log(_context.t0.message);setError(_context.t0.message);}case 20:_context.prev=20;setIsLoading(false);return _context.finish(20);case 23:case\"end\":return _context.stop();}},_callee,null,[[0,17,20,23]]);}));return _fetchMovies.apply(this,arguments);}if((query===null||query===void 0?void 0:query.length)<3){setMovies([]);setError(\"\");return;}//   handleCloseMovie();\nfetchMovies();return function(){controller.abort();};},[query,error]);return{movies:movies,isLoading:isLoading,error:error};}","map":{"version":3,"names":["useState","useEffect","KEY","useMovies","query","_useState","_useState2","_slicedToArray","movies","setMovies","_useState3","_useState4","error","setError","_useState5","_useState6","isLoading","setIsLoading","controller","AbortController","fetchMovies","_fetchMovies","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","data","wrap","_callee$","_context","prev","next","fetch","concat","signal","sent","ok","Error","json","response","Search","t0","name","console","log","message","finish","stop","length","abort"],"sources":["D:/works/react_jonass_course/files/ultimate-react-course-main/07-usepopcorn/final/src/useMovie.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\n\r\nconst KEY = `870ce811`;\r\n\r\nexport function useMovies(query) {\r\n  const [movies, setMovies] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  useEffect(\r\n    function () {\r\n      //   callback?.();\r\n      const controller = new AbortController();\r\n      async function fetchMovies() {\r\n        try {\r\n          setIsLoading(true);\r\n          setError(\"\");\r\n          const res = await fetch(\r\n            `http://www.omdbapi.com/?apikey=${KEY}&s=${query}`,\r\n            { signal: controller.signal }\r\n          );\r\n          if (!res.ok)\r\n            throw new Error(\"some thing went worng with fetching movies\");\r\n\r\n          const data = await res.json();\r\n          if (data.response === \"False\") throw new error(\"Movie Not Found\");\r\n          setMovies(data.Search);\r\n          setError(\"\");\r\n        } catch (err) {\r\n          if (err.name !== \"AbortError\") {\r\n            console.log(err.message);\r\n            setError(err.message);\r\n          }\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      }\r\n\r\n      if (query?.length < 3) {\r\n        setMovies([]);\r\n        setError(\"\");\r\n        return;\r\n      }\r\n      //   handleCloseMovie();\r\n      fetchMovies();\r\n\r\n      return function () {\r\n        controller.abort();\r\n      };\r\n    },\r\n    [query, error]\r\n  );\r\n\r\n  return { movies, isLoading, error };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}